aws_instance:
  terraform_module: "../../../terraform-aws-modules/terraform-aws-ec2-instance"
  # terraform_module: "github.com/finisterra-io/terraform-aws-ec2-instance.git?ref=main"
  terraform_module_version: "5.3.0"
  target_resource_name: default
  fields:
    init_fields:
      function: init_fields
    ami:
      field: ami
      type: string
    availability_zone:
      field: availability_zone
      type: string
    instance_type:
      field: instance_type
      type: string
    ebs_optimized:
      field: ebs_optimized
      type: bool
    disable_api_termination:
      field: disable_api_termination
      type: bool
    user_data:
      field: user_data
      type: string
    user_data_base64:
      field: user_data_base64
      type: string
    instance_profile:
      field: iam_instance_profile
      type: string
    instance_initiated_shutdown_behavior:
      field: instance_initiated_shutdown_behavior
      type: string
    associate_public_ip_address:
      field: associate_public_ip_address
      type: bool
    ssh_key_pair:
      field: key_name
      type: string
    subnet:
      field: subnet_id
      type: string
    monitoring:
      field: monitoring
      type: bool
    private_ip:
      field: private_ip
      type: string
    secondary_private_ips:
      field: secondary_private_ips
      type: list
    source_dest_check:
      field: source_dest_check
      type: bool
    ipv6_address_count:
      field: ipv6_address_count
      type: number
    ipv6_addresses:
      field: ipv6_addresses
      type: list
    tenancy:
      field: tenancy
      type: string
    security_groups:
      field: security_groups
      type: list
    external_network_interfaces:
      field: network_interface
      type: list
    root_volume_type:
      function: get_field_from_attrs
      arg: root_block_device.volume_type
      type: string
    root_volume_size:
      function: get_field_from_attrs
      arg: root_block_device.volume_size
      type: number
    root_iops:
      function: get_field_from_attrs
      arg: root_block_device.iops
      type: number
    root_throughput:
      function: get_field_from_attrs
      arg: root_block_device.throughput
      type: number
    delete_on_termination:
      function: get_field_from_attrs
      arg: root_block_device.delete_on_termination
      type: bool
    root_block_device_encrypted:
      function: get_field_from_attrs
      arg: root_block_device.encrypted
      type: bool
    root_block_device_kms_key_id:
      function: get_field_from_attrs
      arg: root_block_device.kms_key_id
      type: string
    metadata_http_endpoint:
      function: get_field_from_attrs
      arg: metadata_options.http_endpoint
      type: string
    metadata_instance_metadata_tags:
      function: get_field_from_attrs
      arg: metadata_options.instance_metadata_tags
      type: list
    metadata_http_put_response_hop_limit:
      function: get_field_from_attrs
      arg: metadata_options.http_put_response_hop_limit
      type: number
    metadata_http_tokens:
      function: get_field_from_attrs
      arg: metadata_options.http_tokens
      type: string
    burstable_mode:
      function: get_field_from_attrs
      arg: credit_specification.cpu_credits
      type: string
    tags:
      field: tags
      type: map
    volume_tags:
      field: volume_tags
      type: map
  childs:
    aws_eip:
      join:
        id:
          field: instance
      defaults:
        assign_eip_address: true
      target_resource_name: default
      fields:
        tags:
          field: tags
          type: map
    aws_network_interface_attachment:
      join:
        id:
          field: instance_id
      target_resource_name: additional
      second_index:
        function: get_device_index
      fields:
        additional_ips_count:
          function: get_additional_ips_count
          type: number
