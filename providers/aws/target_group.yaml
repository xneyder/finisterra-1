aws_lb_target_group:
  terraform_module: "github.com/finisterra-io/terraform-aws-modules.git//alb/modules/target_group?ref=main"
  terraform_module_version: "5.2.0"
  joined_fields:
    # listener_arn:
    #   sub_fields:
    #     - listener_arn
    listener_rules:
      sub_fields:
        - listener_arn
  target_resource_name: this
  name_field: name
  fields:
    name:
      field: name
      type: string
    port:
      field: port
      type: number
    protocol:
      field: protocol
      type: string
    health_check:
      field: health_check
      type: map
    stickiness:
      field: stickiness
      type: map
    tags:
      field: tags
      type: map
    vpc_name:
      function: get_vpc_name_tg
      type: string
    vpc_id:
      function: get_vpc_id_tg
      type: string
    target_type:
      field: target_type
      type: string
    deregistration_delay:
      field: deregistration_delay
      type: number
  childs:
    aws_lb_listener_rule:
      join:
        name:
          join_function: join_aws_lb_target_group_to_aws_lb_listener_rule
      target_resource_name: this
      second_index:
        function: get_id_from_arn
        arg: arn
      fields:
        # listener_arn:
        #   field: listener_arn
        #   type: string
        listener_rules:
          function: get_listener_rules
          type: map
