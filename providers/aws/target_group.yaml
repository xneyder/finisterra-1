aws_lb_target_group:
  terraform_module: "github.com/finisterra-io/terraform-aws-modules.git//alb/modules/target_group?ref=main"
  terraform_module_version: "5.2.0"
  joined_fields:
    load_balancer_arn:
      sub_fields:
        - load_balancer_arn
  target_resource_name: this
  name_field: name
  fields:
    target_group_name:
      field: name
      type: string
    target_group_port:
      field: port
      type: number
    target_group_protocol:
      field: protocol
      type: string
    target_group_health_check:
      field: health_check
      type: map
    target_group_stickiness:
      field: stickiness
      type: map
    target_group_tags:
      field: tags
      type: map
    vpc_name:
      function: get_vpc_name_ecs
      type: string
    vpc_id:
      function: get_vpc_id_ecs
      type: string
    target_type:
      field: target_type
      type: string
    deregistration_delay:
      field: deregistration_delay
      type: number
  childs:
    aws_lb_listener_rule:
      join:
        name:
          join_function: join_aws_lb_target_group_to_aws_lb_listener_rule
      target_resource_name: this
      second_index:
        function: get_id_from_arn
        arg: arn
      fields:
        listener_rules:
          function: get_listener_rules
          type: map
      childs:
        aws_lb_listener:
          join:
            listener_arn:
              field: arn
          target_resource_name: this
          fields:
            listener_port:
              field: port
              type: number
            listener_protocol:
              field: protocol
              type: string
            listener_default_action:
              field: default_action
              type: map
            listener_certificate_arn:
              field: certificate_arn
              type: string
            load_balancer_arn:
              field: load_balancer_arn
              type: string
            listener_tags:
              field: tags
              type: map
